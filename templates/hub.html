<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel de Administracion â€” Tecnipro</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #f0f4f8;
  --white: #ffffff;
  --text: #1a1d2e;
  --muted: #6b7494;
  --brand: #1e3a8a;
  --brand-light: #3b5fd4;
  --brand-bg: #eff3ff;
  --border: #e2e6f0;
  --green: #059669;
  --green-bg: #ecfdf5;
  --r: 16px;
  --shadow: 0 2px 8px rgba(0,0,0,.06), 0 8px 24px rgba(0,0,0,.05);
  --shadow-lg: 0 4px 16px rgba(0,0,0,.08), 0 12px 40px rgba(0,0,0,.06);
}

body {
  background: var(--bg);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  font-size: 14px;
  line-height: 1.5;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Header */
.hdr {
  background: linear-gradient(135deg, #0c1222 0%, #162036 40%, #1a2d52 70%, #1e3a5f 100%);
  padding: 20px 32px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 4px 16px rgba(12,18,34,.3);
}
.hdr-brand {
  font-size: 18px;
  font-weight: 700;
  color: #fff;
  display: flex;
  align-items: center;
  gap: 10px;
}
.logo-chip {
  background: rgba(255,255,255,.12);
  border-radius: 6px;
  padding: 3px 10px;
  font-size: 11px;
  font-weight: 600;
  letter-spacing: .5px;
  color: rgba(255,255,255,.8);
}
.hdr-right {
  display: flex;
  align-items: center;
  gap: 16px;
}
.hdr-user {
  font-size: 13px;
  color: rgba(255,255,255,.7);
}
.hdr-user strong {
  color: #fff;
  font-weight: 600;
}
.btn-logout {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 7px 16px;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 500;
  color: rgba(255,255,255,.7);
  background: rgba(255,255,255,.08);
  border: 1px solid rgba(255,255,255,.12);
  text-decoration: none;
  transition: all .15s;
}
.btn-logout:hover {
  background: rgba(255,255,255,.15);
  color: #fff;
}

/* Main content */
.hub-main {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px 24px;
}
.hub-container {
  max-width: 880px;
  width: 100%;
}
.hub-title {
  text-align: center;
  margin-bottom: 12px;
}
.hub-title h1 {
  font-size: 28px;
  font-weight: 800;
  color: var(--text);
  letter-spacing: -.3px;
}
.hub-subtitle {
  text-align: center;
  font-size: 15px;
  color: var(--muted);
  margin-bottom: 40px;
}

/* Cards grid */
.hub-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
}

.hub-card {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: var(--r);
  padding: 28px 24px;
  text-decoration: none;
  color: var(--text);
  box-shadow: var(--shadow);
  transition: all .2s ease;
  display: flex;
  align-items: flex-start;
  gap: 18px;
  position: relative;
  overflow: hidden;
}
.hub-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  opacity: 0;
  transition: opacity .2s;
}
.hub-card:hover {
  box-shadow: var(--shadow-lg);
  border-color: var(--brand-light);
  transform: translateY(-2px);
}
.hub-card:hover::before { opacity: 1; }

.hub-card.card-dashboard::before { background: linear-gradient(90deg, #1e3a8a, #3b5fd4); }
.hub-card.card-cotizador::before { background: linear-gradient(90deg, #059669, #34d399); }
.hub-card.card-encuestas::before { background: linear-gradient(90deg, #7c3aed, #a78bfa); }
.hub-card.card-licitaciones::before { background: linear-gradient(90deg, #d97706, #fbbf24); }

.card-icon {
  width: 52px;
  height: 52px;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  flex-shrink: 0;
}
.card-dashboard .card-icon { background: var(--brand-bg); color: var(--brand); }
.card-cotizador .card-icon { background: var(--green-bg); color: var(--green); }
.card-encuestas .card-icon { background: #ede9fe; color: #7c3aed; }
.card-licitaciones .card-icon { background: #fef3c7; color: #d97706; }

.card-body { flex: 1; }
.card-body h2 {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 4px;
  color: var(--text);
}
.card-body p {
  font-size: 13px;
  color: var(--muted);
  line-height: 1.5;
}
.card-arrow {
  font-size: 13px;
  color: var(--muted);
  margin-top: 10px;
  display: flex;
  align-items: center;
  gap: 4px;
  font-weight: 500;
  transition: color .15s;
}
.hub-card:hover .card-arrow { color: var(--brand-light); }
.external-badge {
  display: inline-block;
  font-size: 9px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: .4px;
  padding: 1px 6px;
  border-radius: 4px;
  background: var(--brand-bg);
  color: var(--brand);
  margin-left: 6px;
  vertical-align: middle;
}

/* Footer */
.hub-footer {
  text-align: center;
  padding: 20px;
  font-size: 11px;
  color: var(--muted);
}

/* Loading */
#loading {
  position: fixed;
  inset: 0;
  background: var(--bg);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  gap: 14px;
  z-index: 1000;
}
.spin {
  width: 28px;
  height: 28px;
  border: 3px solid var(--border);
  border-top-color: var(--brand);
  border-radius: 50%;
  animation: sp .7s linear infinite;
}
@keyframes sp { to { transform: rotate(360deg); } }

/* Responsive */
@media (max-width: 640px) {
  .hub-grid { grid-template-columns: 1fr; }
  .hub-title h1 { font-size: 22px; }
  .hdr { padding: 16px 20px; flex-wrap: wrap; gap: 10px; }
  .hub-main { padding: 24px 16px; }
}
</style>
</head>
<body>

<div id="loading">
  <div class="spin"></div>
  <div style="font-size:13px;color:var(--muted)">Cargando...</div>
</div>

<div id="app" style="display:none">

<header class="hdr">
  <div class="hdr-brand">
    Tecnipro <span class="logo-chip">ADMIN</span>
  </div>
  <div class="hdr-right">
    <div class="hdr-user">Hola, <strong id="userName">...</strong></div>
    <a href="/logout" class="btn-logout">Cerrar sesion</a>
  </div>
</header>

<main class="hub-main">
  <div class="hub-container">
    <div class="hub-title">
      <h1>Panel de Administracion</h1>
    </div>
    <div class="hub-subtitle">Selecciona una herramienta para continuar</div>

    <div class="hub-grid">
      <a href="/dashboard" class="hub-card card-dashboard">
        <div class="card-icon"><i class="fas fa-graduation-cap"></i></div>
        <div class="card-body">
          <h2>Dashboard de Cursos</h2>
          <p>Gestion y seguimiento de cursos activos, estudiantes, avance y evaluaciones SENCE.</p>
          <div class="card-arrow">Abrir <i class="fas fa-arrow-right" style="font-size:10px"></i></div>
        </div>
      </a>

      <a href="https://cotizador.tecnipro.cl" target="_blank" class="hub-card card-cotizador">
        <div class="card-icon"><i class="fas fa-file-invoice-dollar"></i></div>
        <div class="card-body">
          <h2>Cotizador de Propuestas <span class="external-badge">externo</span></h2>
          <p>Generacion de propuestas comerciales y cotizaciones para clientes.</p>
          <div class="card-arrow">Abrir en nueva pestana <i class="fas fa-external-link-alt" style="font-size:10px"></i></div>
        </div>
      </a>

      <a href="https://encuestas.tecnipro.cl/dashboard" target="_blank" class="hub-card card-encuestas">
        <div class="card-icon"><i class="fas fa-chart-bar"></i></div>
        <div class="card-body">
          <h2>Encuestas <span class="external-badge">externo</span></h2>
          <p>Dashboard de encuestas de satisfaccion y evaluacion de cursos.</p>
          <div class="card-arrow">Abrir en nueva pestana <i class="fas fa-external-link-alt" style="font-size:10px"></i></div>
        </div>
      </a>

      <a href="/licitaciones" class="hub-card card-licitaciones">
        <div class="card-icon"><i class="fas fa-search-dollar"></i></div>
        <div class="card-body">
          <h2>Licitaciones</h2>
          <p>Monitor de oportunidades en Mercado Publico: licitaciones y ordenes de compra.</p>
          <div class="card-arrow">Abrir <i class="fas fa-arrow-right" style="font-size:10px"></i></div>
        </div>
      </a>
    </div>
  </div>
</main>

<div class="hub-footer">
  Tecnipro &middot; Panel de Administracion
</div>

</div>

<script>
fetch('/api/me')
  .then(function(r) {
    if (!r.ok) throw new Error('No autorizado');
    return r.json();
  })
  .then(function(user) {
    if (user.rol !== 'admin') {
      window.location.href = '/dashboard';
      return;
    }
    document.getElementById('userName').textContent = user.nombre;
    document.getElementById('loading').style.display = 'none';
    document.getElementById('app').style.display = '';
  })
  .catch(function() {
    window.location.href = '/login';
  });
</script>
</body>
</html>
